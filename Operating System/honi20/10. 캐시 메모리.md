# 캐시 메모리

## Cache Memory

- 속도가 빠른 장치와 느린 장치 간의 속도차에 따른 병목 현상을 줄이기 위한 범용 메모리
- 메인 메모리와 CPU 사이에 위치
- 메인 메모리에서 자주 사용하는 프로그램과 데이터를 저장해두어 속도를 빠르게 한다.
- 이를 위해서 CPU가 어떤 데이터를 원하는지 어느 정도 예측할 수 있어야 한다.
  - 작은 크기의 캐시 메모리에 CPU가 이후에 참조할 정보가 어느 정보 들어있는지에 따라 캐시의 성능이 결정되기 때문
- 속도가 빠르다는 장점이 존재한다.
- 용량이 적고 비싸다는 단점이 존재한다.

## Cache Locality

- 데이터에 대한 접근이 시간적 혹은 공간적으로 가깝게 발생하는 것
- 캐시의 적중률(**Hit Rate**)을 극대화하여 캐시가 효율저긍로 동작하기 위해 사용되는 성질
- 전제조건 : 프로그램은 모든 코드나 데이터를 균등하게 접근하지 않는다

#### 공간 지역성 (Spatial Locality)

    최근에 사용했던 데이터와 인접한 데이터가 참조될 가능성이 높다는 특성 (배열)

#### 시간 지역성 (Temparal Locality)

    최근에 사용했던 데이터가 재참조될 가능성이 높다는 특성 (반복문)

## Caching Line

- 캐시 메모리는 메인 메모리에 비해 크기가 매우 작기 때문에 메인 메모리와 1:1 매칭이 불가능하다.
- 데이터가 캐시 내의 어느 곳에 저장되어 있는지 찾기 어려워 모든 데이터를 순회해야 한다면 캐시의 장점을 잃게 된다.  
  -> 쉽게 찾을 수 있는 구조가 필요하다.
  => 캐시에 데이터를 저장할 때 특정 자료구조를 사용하여 묶음으로 저장하는데, 이를 **캐싱 라인**이라 한다.

### [ 캐싱 라인의 매핑 방법 ]

#### 1. Direct Mapping (직접 매핑)

- 메인 메모리를 일정한 크기의 블록으로 나누어 각각의 블록을 캐시의 정해진 위치에 매핑하는 방식
- 장점
  - 가장 간단하고 구현이 쉽다.
- 단점
  - 적중률이 낮아질 수 있다.
  - 동일한 캐시 메모리에 할당된 여러 데이터를 사용할 때 충돌이 발생하게 된다.

#### 2. Full Associative Mapping

- 캐시 메모리의 빈 공간에 마음대로 주소를 저장하는 방식
- 장점
  - 저장하는 것이 매우 간단
- 단점
  - 원하는 데이터가 잇는지 찾기 위해 모든 태그를 병렬적으로 검사해야 함
  - 복잡하고 높은 비용

#### 3. Set Associative Mapping

- Direct Mapping과 Full Associative Mapping의 장점을 결합한 방식
- 빈 공간에 마음대로 주소를 저장하되, 미리 정해둔 특정 행에만 저장하는 방식
- Direct에 비해 검색 속도는 느리지만 저장이 빠름
- Full에 비해 저장이 느리지만 검색이 빠름
- 주로 사용하는 방식

## Cache Miss

- CPU가 참조하려는 데이터가 캐시 메모리에 없을 때 발생

#### Compulsory Miss

    특정 데이터에 처음 접근할 때 발생하는 캐시 미스

#### Capacity Miss

    캐시 메모리의 공간이 부족해서 발생하는 캐시 미스

#### Conflict Miss

    캐시 메모리에 A와 B 데이터를 저장해야 하는데, A와 B가 같은 캐시 메모리 주소에 할당되어 있어 발생하는 캐시 미스
